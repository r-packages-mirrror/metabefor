#' @export
flattenNodeValue <- function(singleValue) {
  
  if (is.expression(singleValue)) {
    singleValue <-
    tryCatch({
      return(eval(singleValue));
    }, error = function(e) {
      return(paste0("Expression ", deparse(substitute(singleValue)),
                    " returned error '", e$message, "' when executed."));
    });
  }
  
  if (is.null(singleValue)) {
    return(NULL);
  } else if (all(is.na(singleValue))) {
    return(NA);
  } else if (length(singleValue) == 1) {
    return(singleValue);
  } else if (is.vector(singleValue)) {
    return(vecTxtQ(singleValue));
  } else if (is.matrix(singleValue)) {
    return(paste(apply(singleValue, 1, vecTxtQ), collapse="\n"));
  } else {
    return(utils::capture.output(utils::str(singleValue)));
  }
}
